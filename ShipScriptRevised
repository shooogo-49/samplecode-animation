

using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class ShipScriptRevised : MonoBehaviour
{
    // 目標：1マス移動
    //一回の運動で1マス分徐々に
    //移動中は入力を受け付けない
    //徐々に動く：コルーチン
    void Start()
    {

    }

    bool isMoving;
    void Update()
    {
        if (isMoving == false)
        {
            float x = Input.GetAxisRaw("Horizontal") * 0.32f;
            float y = Input.GetAxisRaw("Vertical") * 0.32f;

            if (x != 0)
            {
                y = 0;
            }

            //transform.position += new Vector3(x, y);

                StartCoroutine(Move(new Vector2(x, y)));
        }
    }

    IEnumerator Move(Vector3 direction) // new Vector2(x, y)がVector3 directionに代入される
    {
        isMoving = true; //移動中は入力を受け付けない
        Vector3 targetPos = transform.position + direction; //targetPosは変数名
        //現在とターゲットの場所が違うなら近づけ続ける
        while ((targetPos - transform.position).sqrMagnitude > Mathf.Epsilon) //Mathf.Epsilonはとても小さい値
        {
            transform.position = Vector3.MoveTowards(transform.position, targetPos, 1f * Time.deltaTime);
            yield return null; //次のフレームまで待つ
        }

        transform.position = targetPos; //最終的にターゲットの位置に移動
        isMoving = false;
    }
}
